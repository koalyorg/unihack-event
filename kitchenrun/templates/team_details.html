{% extends "base.html" %}
{% load bootstrap5 %}
{% load static %}
{% block content %}
<br>
    <div class = ""></div>
    {% if not pair %}
    <div class="alert alert-primary" role="alert">
        Thank you for signing up for the event. The Organizers will start the pairing of the teams soon. Afterwards you will be able to see your personal schedule for the event.
    </div>
    {% endif %}
    <div class = "container card your-team-box mb-3">
        <div class = "card-body">
            <h5 class="card-title">Your Team: {{ team.name }}</h1>
            <p class="card-text">Members: {{ team.team_member_1 }}, {{ team.team_member_2 }}</p>
        </div>
    </div>

    {% if pair %}
        {% for p in pair %}
            <div class = "container card course mb-3">
                <div class = "card-body">
                    <h5 class="card-title">{{ p.get_course_display }}</h5>
                    {% if p.cook == team %}
                        <p class="card-text warning small"><strong>You are cooking this course!</strong></p>
                        <p class = "card-text alert small">
                            (
                            {% if p.cook.is_vegan or p.guest_1.is_vegan or p.guest_2.is_vegan%}Vegan -{% endif %}
                            {% if p.cook.is_vegetarian or p.guest_1.is_vegetarian or p.guest_2.is_vegetarian%}Vegetarian -{% endif %}
                            {% if p.cook.is_halal or p.guest_1.is_halal or p.guest_2.is_halal%}Halal -{% endif %}
                            {% if p.cook.is_kosher or p.guest_1.is_kosher or p.guest_2.is_kosher%}Kosher -{% endif %}
                            Allergies: {% if p.guest_1.allergies != "" and p.guest_2.allergies != "" %} {{p.guest_1.allergies}} | {{ p.guest_2.allergies }} {% else %} {{p.guest_1.allergies}}{{ p.guest_2.allergies }} {% endif %} | ) <!-- TODO: Allergies-->
                        </p>
                    {% endif %}
                </div>
                {% if p.cook == team %}
                <div class = "item">
                    <p>Guests:</p>
                </div>
                <div class = "item mb-3">
                    <div class = "container card1">
                        <div class = "item dark1">
                            <h1>Team {{ p.guest_1.name }}</h1>
                        </div>
                        <div class = "item">
                            <p>{{ p.guest_1.user.email }}</p>
                        </div>
                    </div>
                    <div class = "container card1">
                        <div class = "item dark1">
                            <h1>Team {{ p.guest_2.name }}</h1>
                        </div>
                        <div class = "item">
                            <p>{{ p.guest_2.user.email }}</p>
                        </div>
                    </div>
                </div>
                {% else %}

                <div class = "item">
                    <p>Host:</p>
                </div>
                <div class = "item mb-3">
                    <div class = "container card1">
                        <div class = "item dark1">
                            <h1>Team {{ p.cook.name }}</h1>
                        </div>
                        <div class = "item">
                            <p>{{ p.cook.user.email }}</p>
                        </div>
                    </div>
                </div>

                <div class = "item">
                    <p>Location: {{ p.cook.street }} {{ p.cook.number }}, {{ p.cook.city }}<br>{{ p.cook.address_addition }}</p>
                </div>
                {% endif %}

                <p></p>
            </div>
        {% endfor %}
            
    {% endif %}

    <script src="{% static 'map/apikey.js' %}"></script>
    <!-- Leaflet -->
    <link rel="stylesheet" href="{% static 'map/leaflet/leaflet.css' %}"/>
    <script src="{% static 'map/leaflet/leaflet.js' %}"></script>
    <link rel="stylesheet" href="{% static 'map/map.css' %}"/>
    <link rel="stylesheet" href="{% static 'style.css' %}"/>
    <!-- Leaflet Routing Machine -->
    <link rel="stylesheet" href="{% static 'map/leaflet-routing/dist/leaflet-routing-machine.css' %}"/>
    <script src="{% static 'map/leaflet-routing/dist/leaflet-routing-machine.js' %}"></script>
    <script src="{% static 'map/lrm-graphhopper.js' %}"></script>

    <!-- Map -->
    <div id="map{{p.course}}"></div>
    <script> var disable_routing = true; var destination = [{{ event.lat }}, {{ event.lon }}] ;</script>
    <script>
        var markers = [[{{ team.lat }}, {{ team.lon }}], [{{ pair.first.guest_1.lat }}, {{ pair.first.guest_1.lon }}], [{{ pair.first.guest_2.lat }}, {{ pair.first.guest_2.lon }}]];
        console.log(markers);
    </script>
    <script src="{% static 'map/map.js' %}"></script>

{% endblock %}
